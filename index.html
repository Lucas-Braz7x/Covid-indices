<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">
  <title>Document</title>
</head>
<body>
  <main class="container">
    <div class="input-search">
      <select id="input" name="input" class="input-text">
      </select>
      <input type="date" class="input-date">
    </div>
    <div class="indice-wrapper">
      <div class="indice">
        <h1 class="indice-title">Total de confirmados</h1>
        <div class="indice-confirmed"></div>
        <div class="indicadores"></div>
      </div>
      <div class="indice">
        <h1 class="indice-title">Total de mortos</h1>
        <p class="indice-death"></p>
        <div class="indicadores"></div>
      </div>
      <div class="indice">
        <h1 class="indice-title">Total de Recuperados</h1>
        <div class="indice-recovered"></div>
        <div class="indicadores"></div>
      </div>
      <div class="indice">
        <h1 class="indice-title">Ativos</h1>
        <p class="indice-active"></p>
        <div class="indicadores"></div>
      </div>
    </div>
  </main>
</body>






<script>
  /*async function getCountries(){
    try{
      let country = document.getElementById('input');
      const response = await fetch('https://api.covid19api.com/countries');
      const data = await response.json();
    }catch(err){
      console.log("Rapaz, deu ruim");
    }
  }

  getCountries();*/

  async function getContent(){
    let country = document.getElementById('input').value;
    console.log(country);

    try{
      if(country == '' || country == null || country == undefined){
        const response = await fetch(`https://api.covid19api.com/summary`);//Pegando a Api
        console.log('entrou aqui');
        const data = await response.json(); //Transformando em json
        console.log(data.Global.TotalConfirmed);
        console.log(data.Countries[1].Country);
        showConfirmed(data);

        let select = document.getElementById('input');
        
        select.innerHTML += (`<option>Global</option>` );

        data.Countries.forEach( dataCountries =>{
          console.log(dataCountries.Country);
          select.innerHTML += (`<option>${dataCountries.Country}</option>` );
        } )
        showRecovered(data);
        showDeaths(data);
        showActive(data);
      }
      
      //const data = await response.json(); //Transformando em json
      
      //Chamando a função criada
      // showConfirmed(data);

    }catch(e){
      console.log("PAM! Erro 404!!!!!!!!!!!!!");
    }

   /*  try{
      const response = await fetch('http://localhost:3010/');//Pegando a Api
      const data = await response.json(); //Transformando em json
      console.log(data[0].Province);
      
      //Chamando a função criada
      showConfirmed(data);

    }catch(e){
      console.log("PAM! Erro 404!!!!!!!!!!!!!");
    } */
  }

  function showConfirmed(confirmed, inputValue = ''){
    let output = '';
    let cont = 0;

    if(inputValue == ''){
      document.querySelector('.indice-confirmed').innerHTML = `<p>${confirmed.Global.TotalConfirmed}</p>`;  
    }else{
      console.log('Entrou no else');
      confirmed.forEach(element => {
        cont += parseInt(element.Confirmed);
      });

      console.log(cont);
      document.querySelector('.indice-confirmed').innerHTML = `<p>${cont}</p>`;
    }
  }
  function showRecovered(recovered, inputValue = ''){
    let output = '';
    let cont = 0;

    if(inputValue == ''){
      document.querySelector('.indice-recovered').innerHTML = `<p>${recovered.Global.TotalRecovered}</p>`;  
    }else{
      
      confirmed.forEach(element => {
        cont += parseInt(element.Confirmed);
      });

      console.log(cont);
      document.querySelector('.indice-confirmed').innerHTML = `<p>${cont}</p>`;
    }
  }
  function showDeaths(deaths, inputValue = ''){
    let output = '';
    let cont = 0;

    if(inputValue == ''){
      document.querySelector('.indice-death').innerHTML = `<p>${deaths.Global.TotalDeaths}</p>`;  
    }else{
      
      confirmed.forEach(element => {
        cont += parseInt(element.Confirmed);
      });

      console.log(cont);
      document.querySelector('.indice-confirmed').innerHTML = `<p>${cont}</p>`;
    }
  }
  function showActive(active, inputValue = ''){
    let output = '';
    let cont = 0;

    if(inputValue == ''){
      document.querySelector('.indice-active').innerHTML = `<p>${active.Global.NewConfirmed}</p>`;  
    }else{
      
      confirmed.forEach(element => {
        cont += parseInt(element.Confirmed);
      });

      console.log(cont);
      document.querySelector('.indice-confirmed').innerHTML = `<p>${cont}</p>`;
    }
  }

  getContent();
</script>
</html>